---
title: "Final Project"
author: "Will, Marcus, Saratessa"
format: html
editor: visual
---

```{r}
setwd("/Users/saratessapalos/Desktop/EDLDClassProject/EDLD651ClassProject/data")

data <- read.csv("updated.csv")
```

```{r}
library(readr)
data <- read_csv("C:/Users/Administrator/Desktop/Final Project/updated_repo/data/updated.csv")
View(data)
```

```{r}
library(here)
library(readr)

data <- read_csv(here("data", "updated.csv"))
```

```{r}
library(tidyverse)
library(readxl)
library(corrplot)
library(viridis)
library(gridExtra)   

# Growth patterns across measures and years

# Letter-Word Identification Boxplot
ggplot(data, aes(x = year)) +
  geom_boxplot(aes(y = LWID_growth, fill = year)) +
  facet_wrap(~"Letter-Word ID Growth") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Math Fluency Growth Boxplot
ggplot(data, aes(x = year)) +
  geom_boxplot(aes(y = MF_growth, fill = year)) +
  facet_wrap(~"Math Fluency Growth by Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Calculation Growth Boxplot
ggplot(data, aes(x = year)) +
  geom_boxplot(aes(y = CALC_growth, fill = year)) +
  facet_wrap(~"Calculation Growth by Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Growth distribution violin plots
long_data <- data %>%
  pivot_longer(
    cols = ends_with("_growth"),
    names_to = "measure",
    values_to = "growth"
  )

ggplot(long_data, aes(x = measure, y = growth, fill = year)) +
  geom_violin() +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Statistical summary by measure
growth_summary <- data %>%
  group_by(year) %>%
  summarize(
    across(ends_with("_growth"),
           list(
             mean = ~mean(., na.rm = TRUE),
             sd = ~sd(., na.rm = TRUE),
             n = ~sum(!is.na(.))
           ))
  )

print(growth_summary)

# Cross-domain comparison
ggplot(data) +
  geom_point(aes(x = RC_growth, y = Math_growth, color = year)) +
  geom_smooth(aes(x = RC_growth, y = Math_growth), method = "lm") +
  theme_minimal() + 
  facet_wrap(~year)
  labs(
    title = "Reading vs Math Growth Correlation",
       x = "Reading Growth",
       y = "Math Growth" 
  )
 
#Writing growth per year
#Writing Assesment
ggplot(data, aes(x = year)) +
  geom_boxplot(aes(y = WA_growth, fill = year)) +
  facet_wrap(~"Writing Assesment Growth by Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

#Writing Fluency
ggplot(data, aes(x = year)) +
  geom_boxplot(aes(y = WF_growth, fill = year)) +
  facet_wrap(~"Writing Fluency by Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

#Writing Skills
ggplot(data, aes(x = year)) +
  geom_boxplot(aes(y = WS_growth, fill = year)) +
  facet_wrap(~"Writing S Growth by Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle =.45, hjust = 1))

#Writing Assessment mean growth per year bar chart.
ggplot(growth_summary, aes(x = year, y = WA_growth_mean, fill = year)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_minimal() +
  labs(
    title = "Writing Assesment Growth by Year",
    x = "Year",
    y = "Growth"
  )

#Writing Fluency mean growth per year bar chart.
ggplot(growth_summary, aes(x = year, y = WF_growth_mean, fill = year)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_minimal() +
  labs(
    title = "Writing Fluency Growth by Year",
    x = "Year",
    y = "Growth"
  )

#Writing Skills mean growth per year bar chart. 
ggplot(growth_summary, aes(x = year, y = WS_growth_mean, fill = year)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_minimal() +
  labs(
    title = "Writing Skills Growth by Year",
    x = "Year",
    y = "Growth"
  )

#Reading growth per year
#BOXPLOTS
#Reading comprehension boxplot
ggplot(data, aes(x = year)) +
  geom_boxplot(aes(y = RC_growth, fill = year)) +
  facet_wrap(~"Reading Comprehension Growth by Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

#Reading fluency boxplot
ggplot(data, aes(x = year)) +
  geom_boxplot(aes(y = RF_growth, fill = year)) +
  facet_wrap(~"Reading Comprehension Growth by Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

#Letter-Word Identification boxplot
ggplot(data, aes(x = year)) +
  geom_boxplot(aes(y = LWID_growth, fill = year)) +
  facet_wrap(~"Letter-Word Identification Growth by Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


```

```{r}
#Modifying growth summary.

growth_summary <- growth_summary %>% 
  select(-starts_with("WJ"))

growth_summary <- growth_summary %>% 
  select(-starts_with("ITBS"))
```
